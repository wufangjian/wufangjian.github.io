---
layout: post
title:  "变量的声明提升 与 TDZ [js]"
date:   2017-01-22 16:16:16 +0800
categories: [js]
---

> 此文章主要是想指出，通常我们认为js中 var定义的变量会发生声明提升，而let/const 定义的变量不会发生声明的提升 

其实：`let/const/var` 定义的变量 `都会发生声明提升`

## 声明提升

先来看个例子

```javascript

var  a = 1

;(function() {
  console.log(a)
  let a = 2
})()
```

如果没有发生变量声明提升，那么console.log应该输出 1

但实际上此处发生了 ReferenceError（引用错误） 对象表明一个不存在的变量被引用。

那麽：

解释：var/[let、const] 声明的变量在发生声明提升时，初始化行为不同

- **var** 声明的变量初始化为 `undefined `

- **let/const** 声明的变量会保持为未初始`(uninitialised)`化状态

```javascript
(function() {
  console.log(a)  // undefined, a 在这里会被初始化为 undefined
  console.log(b)  // ReferenceError, b 在这里会保持为未初始化的状态不变
  var a = 1
  let b = 2
})()
```

## TDZ

**概念**：TDZ 并不是某个地方， 或是内存中的某个区域，而是变量被声明和被初始化之间的这段时间

例子：

```javascript
let a = "outer"

;(function() {
  // 内部的 a 变量在这里被声明，TDZ 开始的地方
  
  console.log(a)  // ReferenceError
  
  let a = "inner"  // a 变量被初始化，TDZ 结束
 })()
```


稍微复杂一点的例子：

```javascript
var a = a // 没有问题

let b = b //  ReferenceError，在这里b并没有完全的被初始化,还处在 TDZ 当中
```

## 场景

```javascript
var x = 1;
function foo(x = x) {
  console.log(x)
}

foo();
```



